const user = JSON.parse(localStorage.getItem("currentUser"));
const storageKey = `accounts_${user.id}`;

function getAccounts() {
  return JSON.parse(localStorage.getItem(storageKey)) || [];
}

function saveAccounts(accounts) {
  localStorage.setItem(storageKey, JSON.stringify(accounts));
}

function renderAccounts() {
  const list = document.getElementById("accountsList");
  const accounts = getAccounts();

  if (accounts.length === 0) {
    list.innerHTML = `<p class="text-slate-400 text-sm">Henüz hesap eklenmedi.</p>`;
    return;
  }

  list.innerHTML = accounts.map(acc => `
    <div class="flex justify-between items-center bg-slate-900/40 p-4 rounded-2xl">
      <div>
        <p class="font-semibold">${acc.name}</p>
        <p class="text-sm text-slate-400">${acc.balance.toLocaleString()} ₺</p>
      </div>
      <button onclick="deleteAccount(${acc.id})"
        class="text-red-400 text-sm hover:text-red-300">
        Sil
      </button>
    </div>
  `).join("");
}

function addAccount() {
  const name = document.getElementById("accountName").value.trim();
  const balance = parseFloat(document.getElementById("accountBalance").value);

  if (!name || isNaN(balance)) {
    alert("Lütfen tüm alanları doldurun.");
    return;
  }

  const accounts = getAccounts();
  accounts.push({
    id: Date.now(),
    name,
    balance
  });

  saveAccounts(accounts);
  renderAccounts();

  document.getElementById("accountName").value = "";
  document.getElementById("accountBalance").value = "";
}

function deleteAccount(id) {
  const accounts = getAccounts().filter(acc => acc.id !== id);
  saveAccounts(accounts);
  renderAccounts();
}

renderAccounts();
